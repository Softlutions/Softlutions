<div class="container">
	<div class="col-lg-11">
		<div class="ibox float-e-margins">
			<div class="ibox-title">
				<h5>Mis eventos</h5>
				<button class="btn btn-primary btn-xs pull-right" data-toggle="modal" data-target="#modalCreateEvent">
					Crear evento</button>
				<button data-toggle="modal"
					class="btn btn-success btn-xs pull-right"
					data-target="#asistenteCreacion">Asistente de creación</button>
				<div class="form-group">
					<input type="text" ng-model="search.name"
						placeholder="Buscar evento" class="form-control">
				</div>
			</div>
			<div class="ibox-content">
				<table class="table table-hover">
					<thead>
						<tr>
							<th>Nombre</th>
							<th>Descripción</th>
							<th>Lugar</th>
							<th></th>
						</tr>
					</thead>
					<tbody ng-repeat="event in events | filter:search:strict">
						<tr>
							<td>{{ event.name }}</td>
							<td>{{ event.description }}</td>
							<td>{{ event.place.name }}</td>

							<td>
								<div class="btn-group">
									<button data-toggle="dropdown"
										class="btn btn-primary btn-xs dropdown-toggle">
										Acción <span class="caret"></span>
									</button>
									<ul class="dropdown-menu">
										<li><a ng-click="listContracts(event.eventId)"
											data-toggle="modal" data-target="#modalListContacts">Listar
												contratos</a></li>
										<li><a ng-click="listParticipants(event.eventId)"
											data-toggle="modal" data-target="#modalParticipants">Listar
												participantes</a></li>
										<li><a
											ng-click="auctionEventServices(event); catalogsList()"
											data-toggle="modal" data-target="#modalAuctionEventServices">Subastar
												servicios</a></li>
										<li><a type="button"
											ng-click="geteventById(event.eventId)" data-toggle="modal"
											data-target="#modal-formSendInvitation">Invitar
												participantes de evento</a></li>
										<li class="divider"></li>
										<li ng-show="event.state===0"><a type="button"
											ng-click="publishEvent(event.eventId)" class="text-danger">Publicar</a></li>
										<li ng-show="event.state===1"><a type="button"
											ng-click="cancelEvent(event.eventId)" class="text-danger">Cancelar
												evento</a></li>
									</ul>
								</div>
							</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
		<div id="modal-formSendInvitation" class="modal fade"
			aria-hidden="true">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-body">
						<div class="row">
							<div class="col-sm-12 b-r">
								<h3 class="m-t-none m-b">Enviar correo</h3>
								<form role="form" ng-init="service">
									<div class="form-group">
										<div class="input-group">
											<input type="text" class="form-control"
												placeholder="Ingresar correo para enviar invitacion"
												ng-model="email.to"> <span class="input-group-btn"
												placeholder="Lista de Correos a invitar">
												<button type="button" ng-click="addEmail(email)"
													class="btn btn-primary">+</button>
											</span>
										</div>
										<div id="emailLabels">

											<span class="tag label label-prmmary"
												ng-repeat="item in listOfEmails"> <span>{{item}}</span>
												<a ng-click="deleteEvent(item)"><i
													class="remove glyphicon glyphicon-remove-sign glyphicon-white"></i></a>
											</span>


										</div>
									</div>
									<div class="form-group">
										<label class="font-noraml"><strong>{{event.description}}</strong></label>
									</div>

									<div class="form-group">
										<button class="btn btn-sm btn-primary pull-right m-t-n-xs"
											type="submit" ng-click="sendEmail($event)">
											<strong>Enviar</strong>
										</button>

									</div>

									<div class="form-group">
										<button type="button"
											class="btn btn-sm btn-danger pull-right m-t-n-xs"
											data-dismiss="modal">Cancelar</button>
									</div>


								</form>
							</div>
						</div>
					</div>
				</div>
			</div>

		</div>
	</div>
	<div id="modalParticipants" class="modal fade" role="dialog">
		<div class="modal-dialog">

			<!-- Modal content-->
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal">&times;</button>
					<h4 class="modal-title">Estado de invitados</h4>
				</div>
				<div class="modal-body">
					<table class="table table-hover">
						<thead>
							<tr>
								<th>Nombre</th>
								<th>Estado</th>
								<th>Fecha de envio de la invitación</th>
							</tr>
						</thead>
						<tbody ng-repeat="participant in participants">
							<tr>
								<td>{{ ((participant.user != null) ?
									(participant.user.name+" "+participant.user.lastName1+"
									"+participant.user.lastName2 ) : (
									participant.offlineUser.email)) }}</td>
								<td>{{ ((participant.state == 0) ? "No asistirá" :
									(participant.state == 1) ? "Pendiente" : "Asistirá")}}</td>
								<td>{{ participant.invitationDate | date:'medium' }}</td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
		</div>
	</div>

	<div id="modalAuctionEventServices" class="modal fade" role="dialog">
		<div class="modal-dialog">

			<!-- Modal content-->
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal">&times;</button>
					<h4 class="modal-title">Crear subasta para los servicios del
						evento</h4>
				</div>
				<div class="modal-body">
					<form class="form-horizontal">
						<div class="form-group">
							<label class="col-lg-2 control-label">Nombre</label>
							<div class="col-lg-10">
								<input type="text" placeholder="Nombre" class="form-control"
									id="auctionName">
							</div>
						</div>
						<div class="form-group">
							<label class="col-lg-2 control-label">Tipo de servicio a
								subastar</label>
							<div class="col-lg-10">
								<select id="cboAuctionCatalogs" class="form-control"
									ng-options="c as c.name for c in catalogs"
									ng-click="selectCatalog(selected)" ng-model="selected"></select>
							</div>
						</div>
						<div class="form-group">
							<label class="col-lg-2 control-label">Descripción</label>
							<div class="col-lg-10">
								<textarea rows="5" placeholder="Descripción"
									class="form-control" id="auctionDescription"></textarea>
							</div>
						</div>
					</form>

				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-primary" id="btnCreateAuction"
						ng-click="createAuction()">Crear subasta</button>
				</div>
			</div>
		</div>
	</div>

	<div id="modalListContacts" class="modal fade" role="dialog"
		ng-controller="ContractsCtrl">
		<div class="modal-dialog">

			<!-- Modal content-->
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal">&times;</button>
					<h4 class="modal-title">Contratos del evento</h4>
				</div>
				<div class="modal-body">
					<table class="table table-hover">
						<thead>
							<tr>
								<th>Contrato</th>
								<th>Estado</th>
								<th>Comentario</th>
							</tr>
						</thead>
						<tbody ng-repeat="serviceContact in serviceContacts">
							<tr>
								<td>{{serviceContact.service.name}}</td>
								<td>{{(serviceContact.state==0)?
									"Pendiente":(serviceContact.state==1)?
									"Concretado":"Cancelado"}}</td>
								<td>{{serviceContact.comment}}</td>

								<td ng-if="serviceContact.state != 2">
									<Button
										id="btnCancelService-{{serviceContact.serviceContractId}}"
										class="btn btn-danger" ng-click="cancel(serviceContact)">Cancelar</Button>
								</td>
								<td ng-if="serviceContact.state == 2">
									<Button
										id="btnCancelService-{{serviceContact.serviceContractId}}"
										class="btn btn-warning" ng-click="cancel(serviceContact)"
										disabled>Cancelado</Button>
								</td>
							</tr>
						</tbody>
					</table>

					<!-- Graph morris donut chart -->
					<div class="ibox">
						<div class="ibox-title">
							<h5>Resumen</h5>
						</div>
						<div id="contracts-state-chart" class="hidden"></div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- asisstente de creacion -->
	<div id="asistenteCreacion" class="modal fade" role="dialog">
		<div class="modal-dialog">
			<!-- Modal content-->
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal">&times;</button>
					<h4 class="modal-title">Asitente de creacion</h4>
				</div>
				<div class="modal-body">
					<form id="example-advanced-form" action="#">
						<h3>Crear evento</h3>
						<fieldset>
							<legend>Caso de uso de Enmanuel</legend>
						</fieldset>

						<h3>Subasta</h3>
						<fieldset>Caso de uso de juanca</fieldset>

						<h3>Prepublicación</h3>
						<fieldset>
							<legend>Caso de uso de chat administrativo</legend>
						</fieldset>

						<h3>Publicación</h3>
						<fieldset>
							<legend>Detalles del evento</legend>
						</fieldset>
					</form>
				</div>
			</div>
		</div>
	</div>
	
	<div id="modalCreateEvent" class="modal fade"
		aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<button class="close" data-dismiss="modal">&times;</button>
					<h4 class="modal-title">Crear evento</h4>
				</div>
				
				<form class="form-horizontal">		
					<div class="modal-body">
						<div class="row">
							<div class="col-sm-12">
								<div class="form-group">
									<label class="col-lg-2 control-label">Nombre</label>
									<div class="col-lg-10">
										<input ng-model="eventName" type="text" class="form-control">
									</div>
								</div>
								
								<div class="form-group">
									<label class="col-lg-2 control-label">Descripción</label>
									<div class="col-lg-10">
										<input ng-model="eventDescription" type="text" class="form-control">
									</div>
								</div>
								
								<div class="form-group">
									<label class="col-lg-2 control-label">Descripción larga</label>
									<div class="col-lg-10">
										<input ng-model="eventLargeDescription" type="text" class="form-control">
									</div>
								</div>
							
								<div class="form-group">	
									<label class="col-lg-2 control-label">Tipo de evento</label>
									<div class="col-lg-10">		
										<div class="radio-inline">
										  <label>
										    <input type="radio" ng-model="eventType" ng-value="0" checked>
										    Público
										  </label>
										</div>
										<div class="radio-inline">
										  <label>
										    <input type="radio" ng-model="eventType" ng-value="1">
										    Privado
										  </label>
										</div>
									</div>
								</div> 
								
								<div class="form-group">
									<label class="col-lg-2 control-label">Nombre del lugar</label>
									<div class="col-lg-10">
										<input ng-model="eventPlaceName" type="text" class="form-control">
									</div>
								</div>
								
								 <div class="form-group">
						            <google-map center="map.center" zoom="map.zoom" draggable="true" options="map.options" control="map.control">
						                <markers models="map.markers" coords="'self'" options="'options'" isLabel='true'>
						                </markers>
						            </google-map>
						            <button class="btn btn-primary" ng-click="addCurrentLocation()">Ir a mi localización</button>
						        </div>                
						            
					            <div class="form-group">
						            <label class="control-label">Buscar lugar</label>
						            <input class="form-control" type="text" placeholder="San José, Costa Rica" ng-model="address"/>
						            <button class="btn btn-primary" ng-click="addAddress()">Ir a esta dirección</button>
						            <label class="has-error" ng-show="resultSearch">La dirección no pudo ser encontrada.</label>    
					            </div>
								 						 							
								<div class="form-group">
									<label class='control-label'>Imagen</label>
									<input class="btn btn-primary" type="file" name="inputfile" ngf-pattern="'image/*'"
    									ngf-accept="'image/*'" ngf-max-size="5MB" ng-file-select="onFileSelect($files)">
								</div> 
								
								<div class="modal-footer">
									<button type="submit"
										class="btn btn-primary pull-right" ng-disabled="" ng-click="createEvent()">Crear</button>				
								</div> 
							</div>
						</div>
					</div>
				</form>		
			</div>
		</div>
	</div>