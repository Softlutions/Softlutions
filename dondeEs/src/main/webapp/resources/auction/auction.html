<div class="container">
	<div class="col-lg-11">
		<div class="ibox float-e-margins">
			<div class="ibox-title">
				<h4>Subastas disponibles</h4>
				<select class="form-control m-b"				
					ng-model="selectedCatalog"
					ng-options="serviceCatalog as serviceCatalog.name for serviceCatalog in catalogs ">
					<option value="">Todas las categorias</option>
				</select>
			</div>
			<div ng-show="tempAuctionList.length != 0" class="ibox-content">
				<table class="table table-hover" ng-table="auctionsTable">
					<thead>
						<tr>
							<th class="col-lg-3">Nombre</th>
							<th ng-show="selectedCatalog == null" class="col-lg-2">Categoría</th>
							<th class="col-lg-5">Descripción</th>
							<th class="col-lg-2">Fecha de finalización</th>
							<th></th>
						</tr>
					</thead>
					<tbody ng-repeat="auction in tempAuctionList = ($data | filter : (!!selectedCatalog.serviceCatalogId || undefined) && {serviceCatalog : {serviceCatalogId: selectedCatalog.serviceCatalogId}} : true)">
						<tr>
							<td>{{auction.name}}</td>
							<td ng-show="selectedCatalog == null">{{auction.serviceCatalog.name}}</td>
							<td>{{auction.description}}</td>
							<td>{{auction.date | date:"dd/MM/yyyy ' | ' h:mma"}}</td>
							<td>
								<div class="btn-group">
									<button data-toggle="dropdown"
										class="btn btn-primary btn-xs dropdown-toggle" ng-click="validatelistItem(auction,$index)">
										Acción <span class="caret"></span>
									</button>
									<ul class="dropdown-menu">
										<li><a href="/dondeEs/app#/auctionParticipants/{{auction.auctionId}}">Ver particiantes</a></li>
										<li><a id="liParticipate-{{$index}}" ng-show="$parent.permissions.isPrestatario" 
											   data-toggle="modal" data-target="#registerModal" ng-click="loadServices()">Participar</a></li>
									</ul>
								</div>
							</td>
						</tr>
					</tbody>
				</table>
			</div>
			<div ng-hide="tempAuctionList.length != 0" class="ibox-content">
				<p>No hay subastas disponibles.</p>
			</div>
		</div>
	</div>

	<div id="registerModal" class="modal fade" role="dialog">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal">&times;</button>
					<h4 class="modal-title">Participar en subasta</h4>
				</div>
				<form class="form-horizontal" name="formJoinAuction" ng-submit="formJoinAuction.$valid ? joinAuction() : validationError()">
					<div class="modal-body">
						<div class="form-group">
							<label class="col-lg-2 control-label">Servicio</label>
							<div class="col-lg-10">
								<select class="form-control m-b"
									ng-options="service as service.name for service in services track by service.serviceId"
									ng-model="auctionService.service">
								</select>
							</div>
						</div>
						<div class="form-group">
							<label class="col-lg-2 control-label">Comentario</label>
							<div class="col-lg-10">
								<textarea rows="5" placeholder="Comentario" class="form-control"
									ng-model="auctionService.description" ng-maxlength="255" autofocus required>
								</textarea>
							</div>
						</div>
						<div class="form-group">
							<label class="col-lg-2 control-label">Precio</label>
							<div class="col-lg-10">
								<input type="text" ng-keyup="formatPrice(auctionService.price)" placeholder="Precio" min="0" class="form-control"
									ng-model="auctionService.price" required>
							</div>
						</div>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-sm btn-danger" data-dismiss="modal">Cancelar</button>
						<button type="submit" class="btn btn-sm btn-primary"><b>{{$parent.permissions.isPrestatario ? 'Participar' : 'No'}}</b></button>
					</div>
				</form>
			</div>
		</div>
	</div>
</div>